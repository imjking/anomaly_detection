import pymysql.cursors
def dataload(pname,datatable="datajason"):
    conn = pymysql.connect(host='127.0.0.1',
                           port=3306,
                           user='root',
                           password='root',
                           db="sis",
                           cursorclass=pymysql.cursors.DictCursor)

    cur = conn.cursor()
    data = cur.execute("select * from "+datatable+" where globalname='"+pname+"'")
    info = cur.fetchmany(data)
    valuep = []
    for ii in info:
        valuep.append(float(ii['valuep']))
    cur.close()
    conn.commit()
    conn.close()
    return valuep

def pointInfo(datatable="datajason"):
    conn = pymysql.connect(host='127.0.0.1',
                           port=3306,
                           user='root',
                           password='root',
                           db="sis",
                           cursorclass=pymysql.cursors.DictCursor)

    cur = conn.cursor()
    data = cur.execute("select distinct globalname from "+datatable+";")
    info = cur.fetchmany(data)
    pointnames = []
    for ii in info:
        pointnames.append(ii["globalname"])
    cur.close()
    conn.commit()
    conn.close()
    return pointnames
